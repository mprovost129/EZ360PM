{% extends "base_app.html" %}
{% load static %}
{% load formatting %}
{% block title %}Revenue by Client Â· EZ360PM{% endblock %}

{% block app_content %}
<div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3">
  <div>
    <h1 class="h4 mb-1">Revenue by Client</h1>
    <div class="text-secondary small">Revenue grouped by client for the selected period.</div>
  </div>
  <a class="btn btn-outline-dark" href="{% url 'accounting:reports_home' %}">Reports</a>
          <a class="btn btn-outline-dark" href="?{% if request.GET.start %}start={{ request.GET.start }}&{% endif %}{% if request.GET.end %}end={{ request.GET.end }}&{% endif %}format=csv"><i class="bi bi-download me-1"></i>Export CSV</a>
</div>

<div class="card shadow-sm mb-3">
  <div class="card-body">
    {% include "accounting/partials_date_range.html" %}
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-sm align-middle">
        <thead>
          <tr>
            <th>Client</th>
            <th class="text-end">Revenue</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
            <tr>
              <td>
                {% if r.client__company_name %}{{ r.client__company_name }}{% else %}{{ r.client__last_name }}, {{ r.client__first_name }}{% endif %}
              </td>
              <td class="text-end">{{ r.revenue_cents|cents_to_dollars }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="2" class="text-secondary">No revenue in this range.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
