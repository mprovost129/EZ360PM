{# templates/core/onboarding_company.html #}
{% extends "base.html" %}

{% block head_title %}Create your company · {{ APP_NAME }}{% endblock %}

{% block content %}
<div class="container py-5" style="max-width:720px">
  <div class="card shadow-sm">
    <div class="card-body">
      <h1 class="h4 mb-1">Create your company</h1>
      <p class="text-muted mb-4">Add your brand details. You can change these later.</p>

      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}

      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}

        <div class="mb-3">
          <label class="form-label" for="{{ form.name.id_for_label }}">Company name</label>
          {{ form.name }}
          {% if form.name.errors %}<div class="text-danger small mt-1">{{ form.name.errors }}</div>{% endif %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.logo.id_for_label }}">Logo (optional)</label>
          <div class="d-flex align-items-center gap-3">
            <img id="logoPreview" class="rounded border d-none"
                 alt="Logo preview"
                 style="width:64px;height:64px;object-fit:contain;background:#fff;">
            {{ form.logo }}
          </div>
          <div class="form-text">PNG or JPG. 512×512 or larger looks best.</div>
          {% if form.logo.errors %}<div class="text-danger small mt-1">{{ form.logo.errors }}</div>{% endif %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.address.id_for_label }}">Address</label>
          {{ form.address }}
          {% if form.address.errors %}<div class="text-danger small mt-1">{{ form.address.errors }}</div>{% endif %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.phone.id_for_label }}">Phone</label>
          {{ form.phone }}
          {% if form.phone.errors %}<div class="text-danger small mt-1">{{ form.phone.errors }}</div>{% endif %}
        </div>

        <div class="d-flex gap-2">
          <button class="btn btn-primary" type="submit">Create company</button>
          <a class="btn btn-outline-secondary" href="{% url 'dashboard:home' %}">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (function () {
    const input = document.getElementById('{{ form.logo.id_for_label }}');
    const preview = document.getElementById('logoPreview');
    if (!input || !preview) return;

    input.addEventListener('change', function () {
      const [file] = input.files || [];
      if (file) {
        preview.src = URL.createObjectURL(file);
        preview.classList.remove('d-none');
      } else {
        preview.classList.add('d-none');
        preview.removeAttribute('src');
      }
    });
  })();
</script>
{% endblock %}
