{% extends "base_app.html" %}
{% load static %}
{% block title %}Audit Event · EZ360PM{% endblock %}

{% block content %}
<div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3">
  <div>
    <h1 class="h4 mb-1">Audit event</h1>
    <div class="text-secondary small">{{ event.created_at|date:"Y-m-d H:i:s" }}</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-dark" href="{% url 'audit:event_list' %}">
      <i class="bi bi-arrow-left me-1"></i>Back
    </a>
  </div>
</div>

<div class="row g-3">
  <div class="col-12 col-lg-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="mb-2">
          <div class="text-secondary small">Event</div>
          <div class="fw-semibold">{{ event.event_type }}</div>
        </div>
        <div class="mb-2">
          <div class="text-secondary small">Object</div>
          <div class="fw-semibold">{{ event.object_type }}</div>
          <div class="text-muted small">{{ event.object_id }}</div>
        </div>
        <div class="mb-2">
          <div class="text-secondary small">Actor</div>
          <div class="fw-semibold">
            {% if event.actor %}
              {{ event.actor.display_name|default:event.actor.username_public }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
        <div class="mb-2">
          <div class="text-secondary small">IP / Device</div>
          <div class="small">{{ event.ip_address|default:"—" }}</div>
          <div class="small text-muted text-truncate">{{ event.user_agent|default:"" }}</div>
        </div>
        {% if event.summary %}
          <hr>
          <div class="text-secondary small">Summary</div>
          <div>{{ event.summary }}</div>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-7">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <div>
            <div class="text-secondary small">Payload</div>
            <div class="small text-muted">Raw JSON captured at event time.</div>
          </div>
        </div>
        <pre class="bg-light border rounded p-3 mb-0" style="max-height: 520px; overflow:auto;">{{ event.payload_json|pprint }}</pre>
      </div>
    </div>
  </div>
</div>
{% endblock %}
