<!doctype html>
<html lang="en">
  <body style="margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.5;background:#fff;color:#222;">

    <!-- Preheader (hidden in most clients) -->
    <div style="display:none;max-height:0;max-width:0;overflow:hidden;opacity:0;mso-hide:all;font-size:1px;line-height:1px;color:transparent;">
      {% if mode == "reminder" %}Reminder: {% endif %}Invoice {{ inv.number }} — amount due ${{ inv.balance|default:"0"|floatformat:2|intcomma }}{% if inv.due_date %}, due {{ inv.due_date|date:"Y-m-d" }}{% endif %}
    </div>

    <div style="max-width:640px;margin:0 auto;padding:24px;">
      <h2 style="margin:0 0 8px 0;">
        {% if mode == "reminder" %}Reminder: {% endif %}Invoice {{ inv.number }}
      </h2>

      <p style="margin:0 0 8px 0;">from <strong>{{ inv.company.name }}</strong></p>

      <p style="margin:0 0 8px 0;color:#666;">
        Issued: <strong>{{ inv.issue_date|date:"Y-m-d" }}</strong>
        {% if inv.due_date %} · Due: <strong>{{ inv.due_date|date:"Y-m-d" }}</strong>{% endif %}
      </p>

      <p style="margin:0 0 12px 0;">
        Amount due: <strong>${{ inv.balance|default:"0"|floatformat:2|intcomma }}</strong>
      </p>

      <p style="margin:0 0 16px 0;">
        <a href="{{ public_url }}"
           style="display:inline-block;padding:10px 14px;background:#0d6efd;color:#ffffff;text-decoration:none;border-radius:6px;">
          View &amp; Pay Invoice
        </a>
      </p>

      <!-- Fallback link (some clients block buttons) -->
      <p style="margin:0 0 12px 0;color:#666;word-break:break-word;">
        If the button doesn’t work, open this link:<br>
        <a href="{{ public_url }}" style="color:#0d6efd;text-decoration:none;">{{ public_url }}</a>
      </p>

      {% if note %}
      <div style="white-space:pre-wrap;border-left:3px solid #eee;padding-left:10px;color:#555;margin:16px 0 0 0;">
        {{ note }}
      </div>
      {% endif %}

      {% if mode == "reminder" %}
      <p style="color:#777;margin:16px 0 0 0;">If you've already paid, please ignore this message.</p>
      {% endif %}

      <p style="color:#888;margin-top:24px;">Sent via {{ APP_NAME }}.</p>
    </div>
  </body>
</html>
