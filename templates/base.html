{# templates/base.html #}
{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0d6efd" />
    <meta name="color-scheme" content="light dark" />

    <title>{% block head_title %}{{ APP_NAME }}{% endblock %}</title>

    {# Optional: page-specific meta (description, robots, og tags) #}
    {% block head_meta %}{% endblock %}

    {# Bootstrap & icons #}
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      integrity="sha384-9F4nXoM8m1S0mof8b8FqG6HqVq5k7Qq8b0rj9u1j6s0qF2lH5bB3v2lS1E3S2u3w"
      crossorigin="anonymous"
    />

    {# App styles #}
    <link rel="stylesheet" href="{% static 'app.css' %}" />

    {# Favicons / manifest hooks (optional) #}
    {% block head_icons %}{% endblock %}

    {% block extra_css %}{% endblock %}
  </head>
  <body class="{% block body_class %}{% endblock %}">
    {# Skip link for keyboard users #}
    <a href="#main-content" class="visually-hidden-focusable position-absolute top-0 start-0 m-2 px-3 py-2 bg-light border rounded">
      Skip to content
    </a>

    {# Global nav #}
    {% include "includes/navbar.html" %}

    {# Flash messages with a polite live region #}
    <div class="container mt-3" aria-live="polite">
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags|default:'secondary' }} alert-dismissible fade show" role="status">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    {# Main content #}
    <main id="main-content" class="container py-4" role="main">
      {% block content %}{% endblock %}
    </main>

    {# Footer + cookie banner (order preserved so banner sits above footer) #}
    {% include "dashboard/legal/_cookie_banner.html" %}
    {% include "includes/footer.html" %}

    {# Bootstrap bundle #}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
      defer
    ></script>

    {# Ctrl/Cmd+K quick search focus #}
    <script>
      document.addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "k") {
          const inp = document.querySelector('form[role="search"] input[type="search"]');
          if (inp) {
            e.preventDefault();
            inp.focus();
            try { inp.select(); } catch(_) {}
          }
        }
      });
    </script>

    {# Optional: place modals/overlays here so they arenâ€™t constrained by page containers #}
    {% block body_portal %}{% endblock %}

    {% block extra_js %}{% endblock %}
  </body>
</html>
